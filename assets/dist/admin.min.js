!function(){"use strict";const e=window.jQuery;var s=class{constructor(e={}){this.options={containerSelector:"#ace-redis-settings-form",saveButtonSelector:"#ace-redis-save-btn",messageContainerSelector:"#ace-redis-messages",onSave:null,...e},this.isInitialized=!1,this.hasUnsavedChanges=!1,this.isSaving=!1;try{const e=localStorage.getItem("ace_redis_auto_save_enabled");null===e?("boolean"==typeof this.options.autoSaveEnabled?this.isAutoSaveEnabled=this.options.autoSaveEnabled:this.isAutoSaveEnabled=!0,localStorage.setItem("ace_redis_auto_save_enabled",this.isAutoSaveEnabled?"1":"0")):this.isAutoSaveEnabled="1"===e}catch(e){this.isAutoSaveEnabled=!0}this.isSuccess=!1,this.message="",this.elapsedTime=0,this.intervalId=null,this.originalFormData=null,this.init()}init(){this.isInitialized||(this.createSaveBar(),this.setupEventListeners(),this.captureOriginalFormData(),this.updateSaveButtonState(),this.isInitialized=!0)}createSaveBar(){if(document.querySelector(".ace-redis-save-bar"))return;const e=`\n            <div class="ace-redis-save-bar">\n                <div class="save-bar-content">\n                    <div class="save-bar-left">\n                        <span class="save-message"></span>\n                    </div>\n                    <div class="save-bar-right">\n                        <div class="auto-save-toggle-wrapper">\n                            <label class="ace-switch" for="auto-save-toggle">\n                                <input type="checkbox" id="auto-save-toggle" ${this.isAutoSaveEnabled?"checked":""}>\n                                <span class="ace-slider"></span>\n                            </label>\n                            <span class="toggle-label">Auto-save</span>\n                        </div>\n                        <button type="button" id="save-bar-button" class="button button-primary" disabled>\n                            <span class="dashicons dashicons-admin-settings"></span>\n                            <span class="button-text">Saved</span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `;document.body.insertAdjacentHTML("beforeend",e),this.updateFixedPosition()}setupEventListeners(){e(this.options.containerSelector).on("input change","input, select, textarea",()=>{setTimeout(()=>this.checkForChanges(),10)}),e(document).on("click","#save-bar-button",e=>{e.preventDefault(),this.handleSave()}),e(document).on("change","#auto-save-toggle",()=>{this.toggleAutoSave()}),e(window).on("resize scroll load",()=>this.updateFixedPosition()),e(window).on("beforeunload",e=>{if(this.hasUnsavedChanges&&!this.isSaving){const s="You have unsaved changes. Are you sure you want to leave?";return e.originalEvent.returnValue=s,s}}),window.wp&&wp.hooks&&wp.hooks.addAction("wp-collapse-menu","ace-redis-cache",()=>{setTimeout(()=>this.updateFixedPosition(),300)})}updateFixedPosition(){const e=document.querySelector(".ace-redis-save-bar");if(!e)return;const s=document.querySelector("#adminmenuwrap");if(s){const t=s.offsetWidth;e.style.left=`${t}px`}}captureOriginalFormData(){const s=e(this.options.containerSelector);this.originalFormData=this.getFormDataObject(s)}getFormDataObject(s){const t={};return s.serializeArray().forEach(e=>{if(e.name.startsWith("ace_redis_cache_settings[")){const s=e.name.replace("ace_redis_cache_settings[","").replace("]","");t[s]=e.value}}),s.find('input[type="checkbox"]').each(function(){const s=e(this).attr("name");if(s&&s.startsWith("ace_redis_cache_settings[")){const a=s.replace("ace_redis_cache_settings[","").replace("]","");t[a]=e(this).is(":checked")?"1":"0"}}),t}checkForChanges(){if(!this.originalFormData)return;const s=e(this.options.containerSelector),t=this.getFormDataObject(s),a=JSON.stringify(this.originalFormData)!==JSON.stringify(t);this.setUnsavedChanges(a)}setUnsavedChanges(e){this.hasUnsavedChanges!==e&&(this.hasUnsavedChanges=e,this.updateSaveButtonState(),e?(this.startElapsedTimeTracking(),this.isAutoSaveEnabled&&setTimeout(()=>this.handleAutoSave(),500)):this.stopElapsedTimeTracking())}updateSaveButtonState(){const s=e("#save-bar-button"),t=s.find(".button-text"),a=s.find(".dashicons");this.isSaving?(s.prop("disabled",!0).removeClass("success"),t.text("Saving..."),a.removeClass("dashicons-admin-settings dashicons-yes-alt").addClass("dashicons-update")):this.isSuccess?(s.prop("disabled",!0).addClass("success"),t.text("Saved!"),a.removeClass("dashicons-admin-settings dashicons-update").addClass("dashicons-yes-alt")):this.hasUnsavedChanges?(s.prop("disabled",!1).removeClass("success"),t.text("Save Changes"),a.removeClass("dashicons-update dashicons-yes-alt").addClass("dashicons-admin-settings")):(s.prop("disabled",!0).removeClass("success"),t.text("Saved"),a.removeClass("dashicons-update dashicons-yes-alt").addClass("dashicons-admin-settings"))}async handleSave(){if(this.hasUnsavedChanges&&!this.isSaving){this.setSaving(!0);try{let e=!1;e=this.options.onSave&&"function"==typeof this.options.onSave?await this.options.onSave():await this.defaultSave(),e?(this.showMessage("Settings saved successfully!","success"),this.setSuccess(!0),this.captureOriginalFormData(),this.setUnsavedChanges(!1),setTimeout(()=>this.setSuccess(!1),3e3)):this.showMessage("Save failed. Please try again.","error")}catch(e){console.error("Save error:",e),this.showMessage("An error occurred while saving.","error")}finally{this.setSaving(!1)}}}async handleAutoSave(){if(this.hasUnsavedChanges&&!this.isSaving){console.log("[SaveBar] Auto-saving changes..."),this.showMessage("Auto-saving...","info");try{let e=!1;e=this.options.onSave&&"function"==typeof this.options.onSave?await this.options.onSave():await this.defaultSave(),e?(this.showMessage("Changes auto-saved!","success"),this.captureOriginalFormData(),this.setUnsavedChanges(!1)):this.showMessage("Auto-save failed","error")}catch(e){console.error("[SaveBar] Auto-save error:",e),this.showMessage("Auto-save error occurred","error")}}}async defaultSave(){return new Promise(s=>{const t=e(this.options.containerSelector),a=this.getFormDataObject(t);e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/settings",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{settings:a,nonce:ace_redis_admin.nonce},success:e=>{s(!0===e.success)},error:()=>{s(!1)}})})}setSaving(e){this.isSaving=e,this.updateSaveButtonState()}setSuccess(e){this.isSuccess=e,this.updateSaveButtonState()}showMessage(e,s="info"){this.message=e,this.updateMessageDisplay(s),"success"===s&&this.startElapsedTimeTracking();setTimeout(()=>{this.clearMessage()},"error"===s?8e3:"success"===s?5e3:3e3)}updateMessageDisplay(s="info"){const t=e(".save-message");this.message?t.text(this.message).addClass("visible").removeClass("error success info").addClass(s):t.removeClass("visible error success info").text("")}clearMessage(){this.message="",this.updateMessageDisplay(),this.stopElapsedTimeTracking()}startElapsedTimeTracking(){this.stopElapsedTimeTracking(),this.elapsedTime=0,this.intervalId=setInterval(()=>{this.elapsedTime++,this.updateElapsedTimeDisplay()},1e3)}stopElapsedTimeTracking(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}updateElapsedTimeDisplay(){if(this.elapsedTime>0){const s=this.formatElapsedTime(this.elapsedTime);e(".save-message").text(s)}}formatElapsedTime(e){return e<60?`${e}s ago`:e<3600?`${Math.floor(e/60)}m ago`:`${Math.floor(e/3600)}h ago`}toggleAutoSave(){const s=e("#auto-save-toggle");this.isAutoSaveEnabled=s.is(":checked"),this.isAutoSaveEnabled?this.showMessage("Auto-save enabled - changes will be saved automatically","success"):this.showMessage("Auto-save disabled - manual save required","info");try{localStorage.setItem("ace_redis_auto_save_enabled",this.isAutoSaveEnabled?"1":"0")}catch(e){}if("undefined"!=typeof ace_redis_admin&&ace_redis_admin.ajax_url)try{jQuery.post(ace_redis_admin.ajax_url,{action:"ace_redis_toggle_autosave",nonce:ace_redis_admin.nonce,enabled:this.isAutoSaveEnabled?1:0})}catch(e){}}destroy(){this.stopElapsedTimeTracking(),e(this.options.containerSelector).off("input change"),e(document).off("click","#save-bar-button"),e(document).off("change","#auto-save-toggle"),e(window).off("resize scroll load"),e(window).off("beforeunload"),e(".ace-redis-save-bar").remove(),this.isInitialized=!1}};!function(e){window.AceRedisCacheSaveBar=s;class t{constructor(){this.originalFormData=null,this.init()}init(){this.initTabs(),this.initToggleSwitch(),this.initCacheMode(),this.initConnectionTest(),this.initCacheManagement(),this.initDiagnostics(),this.initPerformanceMetrics(),this.initAjaxForm(),this.initFormValidation(),this.initChangeTracking(),this.initSaveBar()}initSaveBar(){if(void 0!==window.AceRedisCacheSaveBar){let e=!0;if("undefined"!=typeof ace_redis_admin&&null!==ace_redis_admin.user_auto_save)e=!!ace_redis_admin.user_auto_save;else try{const s=localStorage.getItem("ace_redis_auto_save_enabled");null!==s&&(e="1"===s)}catch(e){}this.saveBar=new window.AceRedisCacheSaveBar({containerSelector:"#ace-redis-settings-form",saveButtonSelector:"#ace-redis-save-btn",messageContainerSelector:"#ace-redis-messages",onSave:()=>this.saveSettingsViaSaveBar(),autoSaveEnabled:e,autoSaveInterval:15e3}),console.log("SaveBar initialized successfully")}else console.warn("SaveBar component not loaded, falling back to standard save handling")}async saveSettingsViaSaveBar(){try{const e=await this.performSaveSettings();return e&&setTimeout(()=>{"function"==typeof this.testConnection&&this.testConnection()},1e3),e}catch(e){return console.error("SaveBar save error:",e),!1}}async performSaveSettings(){return new Promise(s=>{e("#ace-redis-settings-form");const t=this.getFormDataObject();e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/settings",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{settings:t,nonce:ace_redis_admin.nonce},success:e=>{e.success?(this.captureOriginalFormData(),s(!0)):s(!1)},error:()=>{s(!1)}})})}initTabs(){e(".nav-tab").on("click",s=>{s.preventDefault();const t=e(s.target).attr("href");this.switchToTab(t),t.startsWith("#")&&(window.location.hash=t)}),e(window).on("hashchange",()=>{this.handleHashChange()}),this.handleHashChange()}switchToTab(s){s&&e(s).length&&(e(".nav-tab").removeClass("nav-tab-active"),e(`.nav-tab[href="${s}"]`).addClass("nav-tab-active"),e(".tab-content.active").removeClass("active"),setTimeout(()=>{e(s).addClass("active"),"#diagnostics"===s?(setTimeout(()=>{e("#refresh-metrics-btn").click()},100),this.resumeAutoRefreshTimer()):this.pauseAutoRefreshTimer()},50))}handleHashChange(){let s=window.location.hash;if(!s||!e(s).length){const t=e(".nav-tab").first().attr("href");t&&(s=t)}s&&e(s).length&&this.switchToTab(s)}initToggleSwitch(){e(".ace-switch input").on("change",function(){const s=e(this),t=s.siblings(".ace-slider");s.is(":checked")?t.addClass("checked"):t.removeClass("checked")})}initCacheMode(){const s=()=>{const s=e("#cache-mode-select").val(),t=e("#block-caching-row"),a=e('input[name="ace_redis_cache_settings[enable_block_caching]"]'),i=e("#transient-cache-row"),n=e('input[name="ace_redis_cache_settings[enable_transient_cache]"]'),o="object"===s;t.toggle(o),i.toggle(o),o||(a.prop("checked",!1),n.prop("checked",!1))};s(),e("#cache-mode-select").on("change",s)}initConnectionTest(){e("#ace-redis-cache-test-btn").on("click",e=>{e.preventDefault(),this.testConnection()}),e("#ace-redis-cache-test-write-btn").on("click",e=>{e.preventDefault(),this.testWriteRead()})}testConnection(){const s=e("#ace-redis-cache-test-btn"),t=s.text();s.text("Testing...").prop("disabled",!0),e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/test-connection",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce}}).done(e=>{e.success?this.updateConnectionStatus(e.data):this.showConnectionError(e.data||"Connection failed")}).fail(()=>{this.showConnectionError("REST API request failed")}).always(()=>{s.text(t).prop("disabled",!1)})}testWriteRead(){const s=e("#ace-redis-cache-test-write-btn"),t=s.text();s.text("Testing...").prop("disabled",!0),e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/test-write-read",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce}}).done(e=>{e.success?this.showNotification(`✅ Write/Read Test Successful\nWrite: ${e.data.write}\nRead: ${e.data.read}\nValue: ${e.data.value}`,"success"):this.showNotification(`❌ Test failed: ${e.data}`,"error")}).fail(()=>{this.showNotification("❌ REST API request failed","error")}).always(()=>{s.text(t).prop("disabled",!1)})}updateConnectionStatus(s){const t=e("#ace-redis-cache-connection"),a=e("#ace-redis-cache-size"),i=e("#redis-server-info"),n=e("#redis-server-type"),o=e("#redis-suggestions");t.text(s.status).removeClass("status-unknown status-error").addClass("status-success");let r=`${s.size} keys (${s.size_kb} KB)`;if(s.debug_info&&(r+=` - ${s.debug_info}`),a.text(r),s.server_type||s.suggestions){if(n.text(s.server_type||"Unknown"),s.suggestions&&s.suggestions.length>0){let e="<p><strong>Recommendations:</strong></p><ul>";s.suggestions.forEach(s=>{e+=`<li>${s}</li>`}),e+="</ul>",o.html(e)}else o.html("<p><strong>Recommendations:</strong> Configuration looks good ✅</p>");i.slideDown(300)}}showConnectionError(s){const t=e("#ace-redis-cache-connection"),a=e("#ace-redis-cache-size"),i=e("#redis-server-info");t.text(s).removeClass("status-unknown status-success").addClass("status-error"),a.text("0 keys (0 KB)"),i.slideUp(300)}initCacheManagement(){e("#ace-redis-cache-flush-btn").on("click",e=>{e.preventDefault(),this.clearAllCache()})}clearAllCache(){if(!confirm("Are you sure you want to clear all cache? This action cannot be undone."))return;const s=e("#ace-redis-cache-flush-btn"),t=s.text();s.text("Clearing...").prop("disabled",!0),e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/flush-cache",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce,type:"all"}}).done(s=>{s.success?(this.showNotification(`✅ ${s.data.message||"Cache cleared successfully"}`,"success"),e("#ace-redis-cache-size").text("0 keys (0 KB)")):this.showNotification(`❌ Failed to clear cache: ${s.data}`,"error")}).fail(()=>{this.showNotification("❌ REST API request failed","error")}).always(()=>{s.text(t).prop("disabled",!1)})}initDiagnostics(){e("#ace-redis-cache-diagnostics-btn").on("click",e=>{e.preventDefault(),this.runDiagnostics()})}runDiagnostics(){const s=e("#ace-redis-cache-diagnostics-btn"),t=e("#diagnostics-results"),a=s.text();s.text("Running...").prop("disabled",!0),t.html("<p>⏳ Running comprehensive diagnostics...</p>"),e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/diagnostics",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce}}).done(e=>{if(e.success&&e.data){const s=Array.isArray(e.data)?e.data.join("\n"):e.data;t.html(`<pre>${this.escapeHtml(s)}</pre>`)}else t.html(`<p class="error">❌ Failed to load diagnostics: ${e.data||"Unknown error"}</p>`)}).fail(()=>{t.html('<p class="error">❌ Diagnostics REST API request failed</p>')}).always(()=>{s.text(a).prop("disabled",!1)})}initFormValidation(){e("#ace-redis-save-btn").on("click",e=>{if(!this.validateForm())return e.preventDefault(),!1}),e("#redis_host").on("blur",this.validateHost),e("#redis_port").on("blur",this.validatePort),e("#cache_ttl").on("blur",this.validateTTL)}validateForm(){let s=!0;const t=[];e("#redis_host").val().trim()||(t.push("Redis host is required"),s=!1);const a=parseInt(e("#redis_port").val());(!a||a<1||a>65535)&&(t.push("Redis port must be between 1 and 65535"),s=!1);const i=parseInt(e("#cache_ttl").val());return(!i||i<60)&&(t.push("Cache TTL must be at least 60 seconds"),s=!1),s||this.showNotification(`❌ Validation errors:\n${t.join("\n")}`,"error"),s}validateHost(){const s=e(this);return s.val().trim()?(s.removeClass("error"),!0):(s.addClass("error"),!1)}validatePort(){const s=e(this),t=parseInt(s.val());return!t||t<1||t>65535?(s.addClass("error"),!1):(s.removeClass("error"),!0)}validateTTL(){const s=e(this),t=parseInt(s.val());return!t||t<60?(s.addClass("error"),!1):(s.removeClass("error"),!0)}showNotification(e,s="info"){alert(e)}initAjaxForm(){console.log("Initializing AJAX form..."),e("#ace-redis-settings-form").on("submit",e=>(console.log("Form submit intercepted"),e.preventDefault(),e.stopPropagation(),this.saveSettings(),!1)),e("#ace-redis-save-btn").on("click",e=>(console.log("Save button clicked"),e.preventDefault(),e.stopPropagation(),this.saveSettings(),!1))}initChangeTracking(){setTimeout(()=>{const s=e("#ace-redis-save-btn");s.data("original-text")||s.data("original-text",s.val()),this.captureOriginalFormData(),this.updateSaveButtonState(),e("#ace-redis-settings-form input, #ace-redis-settings-form select, #ace-redis-settings-form textarea").on("input change",()=>{setTimeout(()=>this.updateSaveButtonState(),10)})},100)}captureOriginalFormData(){this.originalFormData=this.getFormDataObject()}hasFormChanges(){if(!this.originalFormData)return!1;const e=this.getFormDataObject();return JSON.stringify(this.originalFormData)!==JSON.stringify(e)}updateSaveButtonState(){const s=e("#ace-redis-save-btn"),t=this.hasFormChanges();s.prop("disabled",!t),t?s.val(s.data("original-text")||"Save Changes"):s.val(s.data("original-text")||"Save Changes (No Changes)")}getFormDataObject(){const s=e("#ace-redis-settings-form"),t={};return s.serializeArray().forEach(e=>{if(e.name.startsWith("ace_redis_cache_settings[")){const s=e.name.replace("ace_redis_cache_settings[","").replace("]","");t[s]=e.value}}),s.find('input[type="checkbox"]').each(function(){const s=e(this).attr("name");if(s&&s.startsWith("ace_redis_cache_settings[")){const a=s.replace("ace_redis_cache_settings[","").replace("]","");t[a]=e(this).is(":checked")?"1":"0"}}),t}saveSettings(){this.saveBar?this.saveBar.handleSave():this.performOriginalSave()}performOriginalSave(){if(!this.hasFormChanges())return void this.showMessage("Error: Failed to save settings. No changes detected or database error.","error");e("#ace-redis-settings-form");const s=e("#ace-redis-save-btn"),t=e("#ace-redis-messages");console.log("REST API Save triggered...");const a=s.val();s.val("Saving...").prop("disabled",!0),t.hide();const i=this.getFormDataObject();console.log("Sending data:",i),console.log("REST URL:",ace_redis_admin.rest_url+"ace-redis-cache/v1/settings"),e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/settings",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce),console.log("Set REST nonce:",ace_redis_admin.rest_nonce)},data:{settings:i,nonce:ace_redis_admin.nonce},success:e=>{console.log("Success response:",e),e.success?(this.showMessage(e.message||"Settings saved successfully!","success"),this.captureOriginalFormData(),this.updateSaveButtonState(),setTimeout(()=>{"function"==typeof this.testConnection&&this.testConnection()},1e3)):this.showMessage(e.message||"Failed to save settings","error")},error:(e,s,t)=>{console.error("Save error:",{status:e.status,statusText:e.statusText,responseText:e.responseText,error:t});let a="Network error occurred";a=e.responseJSON&&e.responseJSON.message?e.responseJSON.message:504===e.status?"Gateway timeout - settings may still be saved. Please refresh the page.":403===e.status?"Permission denied. Please refresh the page and try again.":404===e.status?"REST API endpoint not found. The plugin may not be properly configured.":`${t} (Status: ${e.status})`,this.showMessage("Error: "+a,"error")},complete:()=>{s.val(a).prop("disabled",!1)}})}showMessage(s,t="success"){const a=e("#ace-redis-messages"),i="success"===t?"notice-success":"notice-error";a.html(`\n                <div class="notice ${i} is-dismissible">\n                    <p>${this.escapeHtml(s)}</p>\n                    <button type="button" class="notice-dismiss">\n                        <span class="screen-reader-text">Dismiss this notice.</span>\n                    </button>\n                </div>\n            `).show(),"success"===t&&setTimeout(()=>{a.fadeOut()},5e3),a.find(".notice-dismiss").on("click",function(){a.fadeOut()})}initPerformanceMetrics(){e("#diagnostics").hasClass("active")&&setTimeout(()=>{e("#refresh-metrics-btn").click()},100),this.initAutoRefresh(),e("#refresh-metrics-btn").on("click",()=>{this.loadPerformanceMetrics();const s=e("#refresh-metrics-btn");s.prop("disabled",!0).html("⏳"),setTimeout(()=>{s.prop("disabled",!1).html("🔄")},1e3)})}initAutoRefresh(){this.autoRefreshInterval=null,this.countdownInterval=null,this.remainingSeconds=0;const s=()=>{const s=e("#refresh-timer");this.remainingSeconds>0?(s.text(`Next refresh in ${this.remainingSeconds}s`),this.remainingSeconds--):s.text("")};this.startAutoRefresh=t=>{this.autoRefreshInterval&&clearInterval(this.autoRefreshInterval),this.countdownInterval&&clearInterval(this.countdownInterval);const a=e("#refresh-timer");t>0?(this.remainingSeconds=t,this.countdownInterval=setInterval(s,1e3),this.autoRefreshInterval=setInterval(()=>{e("#diagnostics").hasClass("active")&&(e("#refresh-metrics-btn").click(),this.remainingSeconds=t)},1e3*t),s()):a.text("")},e("#auto-refresh-select").on("change",()=>{const s=parseInt(e("#auto-refresh-select").val());this.startAutoRefresh(s)}),this.startAutoRefresh(30)}pauseAutoRefreshTimer(){this.countdownInterval&&clearInterval(this.countdownInterval),e("#refresh-timer").text("")}resumeAutoRefreshTimer(){const s=parseInt(e("#auto-refresh-select").val());s>0&&this.startAutoRefresh(s)}loadPerformanceMetrics(){e("#diagnostics").hasClass("active")&&e.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/metrics",type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},success:s=>{e("#diagnostics").hasClass("active")&&(s.success&&s.data||s.data)&&this.updateMetricsDisplay(s.data)},error:()=>{this.updateMetricsDisplay({cache_hit_rate:"--",total_keys:"--",memory_usage:"--",response_time:"--",uptime:"--",connected_clients:"--",ops_per_sec:"--"})}})}updateMetricsDisplay(s){console.log("Debug keyspace stats:",{hits:s.debug_keyspace_hits,misses:s.debug_keyspace_misses,hit_rate:s.cache_hit_rate}),e("#performance-metrics .metric-card").each(function(){const t=e(this),a=t.find(".metric-value"),i=t.find("h4").text();let n="--";switch(i){case"Cache Hit Rate":n=s.cache_hit_rate||"--";break;case"Total Keys":n=s.total_keys||"--";break;case"Memory Usage":n=s.memory_usage||"--";break;case"Plugin Memory":n=s.plugin_memory_total||"--";const e=t.find(".metric-description"),a=[];s.plugin_memory_page&&a.push(`Page ${s.plugin_memory_page}`),s.plugin_memory_minified&&a.push(`Minified ${s.plugin_memory_minified}`),s.plugin_memory_blocks&&a.push(`Blocks ${s.plugin_memory_blocks}`),s.plugin_memory_transients&&a.push(`Transients ${s.plugin_memory_transients}`),a.length&&e.text(a.join(" | "));break;case"Response Time":n=s.response_time||"--";break;case"Uptime":n=s.uptime||"--";break;case"Connected Clients":n=s.connected_clients||"--";break;case"Operations/sec":case"Ops/sec":n=s.ops_per_sec||"--";break;case"Connection Time":n=s.connection_time||"--"}a.text()!==n?a.fadeOut(100,function(){e(this).text(n).fadeIn(100)}):a.text(n)});const t=(new Date).toLocaleTimeString();e(".metrics-last-updated").text(`Last updated: ${t}`)}escapeHtml(e){const s=document.createElement("div");return s.textContent=e,s.innerHTML}}e(document).ready(()=>{new t})}(jQuery)}();
//# sourceMappingURL=admin.min.js.map