!function(){"use strict";var e=class{constructor(e={}){this.options={containerSelector:"#ace-redis-settings-form",saveButtonSelector:"#ace-redis-save-btn",messageContainerSelector:"#ace-redis-messages",onSave:null,...e},this.isInitialized=!1,this.hasUnsavedChanges=!1,this.isSaving=!1;try{const e=localStorage.getItem("ace_redis_auto_save_enabled");null===e?("boolean"==typeof this.options.autoSaveEnabled?this.isAutoSaveEnabled=this.options.autoSaveEnabled:this.isAutoSaveEnabled=!0,localStorage.setItem("ace_redis_auto_save_enabled",this.isAutoSaveEnabled?"1":"0")):this.isAutoSaveEnabled="1"===e}catch(e){this.isAutoSaveEnabled=!0}this.isSuccess=!1,this.message="",this.elapsedTime=0,this.intervalId=null,this.originalFormData=null,this.init()}init(){this.isInitialized||(this.createSaveBar(),this.setupEventListeners(),this.captureOriginalFormData(),this.updateSaveButtonState(),this.isInitialized=!0)}createSaveBar(){if(document.querySelector(".ace-redis-save-bar"))return;const e=`\n            <div class="ace-redis-save-bar">\n                <div class="save-bar-content">\n                    <div class="save-bar-left">\n                        <span class="save-message"></span>\n                    </div>\n                    <div class="save-bar-right">\n                        <div class="auto-save-toggle-wrapper">\n                            <label class="ace-switch" for="auto-save-toggle">\n                                <input type="checkbox" id="auto-save-toggle" ${this.isAutoSaveEnabled?"checked":""}>\n                                <span class="ace-slider"></span>\n                            </label>\n                            <span class="toggle-label">Auto-save</span>\n                        </div>\n                        <button type="button" id="save-bar-button" class="button button-primary" disabled>\n                            <span class="dashicons dashicons-admin-settings"></span>\n                            <span class="button-text">Saved</span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        `;document.body.insertAdjacentHTML("beforeend",e),this.updateFixedPosition()}setupEventListeners(){$(this.options.containerSelector).on("input change","input, select, textarea",()=>{setTimeout(()=>this.checkForChanges(),10)}),$(document).on("click","#save-bar-button",e=>{e.preventDefault(),this.handleSave()}),$(document).on("change","#auto-save-toggle",()=>{this.toggleAutoSave()}),$(window).on("resize scroll load",()=>this.updateFixedPosition()),$(window).on("beforeunload",e=>{if(this.hasUnsavedChanges&&!this.isSaving){const s="You have unsaved changes. Are you sure you want to leave?";return e.originalEvent.returnValue=s,s}}),window.wp&&wp.hooks&&wp.hooks.addAction("wp-collapse-menu","ace-redis-cache",()=>{setTimeout(()=>this.updateFixedPosition(),300)})}updateFixedPosition(){const e=document.querySelector(".ace-redis-save-bar");if(!e)return;const s=document.querySelector("#adminmenuwrap");if(s){const t=s.offsetWidth;e.style.left=`${t}px`}}captureOriginalFormData(){const e=$(this.options.containerSelector);this.originalFormData=this.getFormDataObject(e)}getFormDataObject(e){const s={};return e.serializeArray().forEach(e=>{if(e.name.startsWith("ace_redis_cache_settings[")){const t=e.name.replace("ace_redis_cache_settings[","").replace("]","");s[t]=e.value}}),e.find('input[type="checkbox"]').each(function(){const e=$(this).attr("name");if(e&&e.startsWith("ace_redis_cache_settings[")){const t=e.replace("ace_redis_cache_settings[","").replace("]","");s[t]=$(this).is(":checked")?"1":"0"}}),s}checkForChanges(){if(!this.originalFormData)return;const e=$(this.options.containerSelector),s=this.getFormDataObject(e),t=JSON.stringify(this.originalFormData)!==JSON.stringify(s);this.setUnsavedChanges(t)}setUnsavedChanges(e){this.hasUnsavedChanges!==e&&(this.hasUnsavedChanges=e,this.updateSaveButtonState(),e?(this.startElapsedTimeTracking(),this.isAutoSaveEnabled&&setTimeout(()=>this.handleAutoSave(),500)):this.stopElapsedTimeTracking())}updateSaveButtonState(){const e=$("#save-bar-button"),s=e.find(".button-text"),t=e.find(".dashicons");this.isSaving?(e.prop("disabled",!0).removeClass("success"),s.text("Saving..."),t.removeClass("dashicons-admin-settings dashicons-yes-alt").addClass("dashicons-update")):this.isSuccess?(e.prop("disabled",!0).addClass("success"),s.text("Saved!"),t.removeClass("dashicons-admin-settings dashicons-update").addClass("dashicons-yes-alt")):this.hasUnsavedChanges?(e.prop("disabled",!1).removeClass("success"),s.text("Save Changes"),t.removeClass("dashicons-update dashicons-yes-alt").addClass("dashicons-admin-settings")):(e.prop("disabled",!0).removeClass("success"),s.text("Saved"),t.removeClass("dashicons-update dashicons-yes-alt").addClass("dashicons-admin-settings"))}async handleSave(){if(this.hasUnsavedChanges&&!this.isSaving){this.setSaving(!0);try{let e=!1;e=this.options.onSave&&"function"==typeof this.options.onSave?await this.options.onSave():await this.defaultSave(),e?(this.showMessage("Settings saved successfully!","success"),this.setSuccess(!0),this.captureOriginalFormData(),this.setUnsavedChanges(!1),setTimeout(()=>this.setSuccess(!1),3e3)):this.showMessage("Save failed. Please try again.","error")}catch(e){console.error("Save error:",e),this.showMessage("An error occurred while saving.","error")}finally{this.setSaving(!1)}}}async handleAutoSave(){if(this.hasUnsavedChanges&&!this.isSaving){console.log("[SaveBar] Auto-saving changes..."),this.showMessage("Auto-saving...","info");try{let e=!1;e=this.options.onSave&&"function"==typeof this.options.onSave?await this.options.onSave():await this.defaultSave(),e?(this.showMessage("Changes auto-saved!","success"),this.captureOriginalFormData(),this.setUnsavedChanges(!1)):this.showMessage("Auto-save failed","error")}catch(e){console.error("[SaveBar] Auto-save error:",e),this.showMessage("Auto-save error occurred","error")}}}async defaultSave(){return new Promise(e=>{const s=$(this.options.containerSelector),t=this.getFormDataObject(s);$.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/settings",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{settings:t,nonce:ace_redis_admin.nonce},success:s=>{e(!0===s.success)},error:()=>{e(!1)}})})}setSaving(e){this.isSaving=e,this.updateSaveButtonState()}setSuccess(e){this.isSuccess=e,this.updateSaveButtonState()}showMessage(e,s="info"){this.message=e,this.updateMessageDisplay(s),"success"===s&&this.startElapsedTimeTracking();setTimeout(()=>{this.clearMessage()},"error"===s?8e3:"success"===s?5e3:3e3)}updateMessageDisplay(e="info"){const s=$(".save-message");this.message?s.text(this.message).addClass("visible").removeClass("error success info").addClass(e):s.removeClass("visible error success info").text("")}clearMessage(){this.message="",this.updateMessageDisplay(),this.stopElapsedTimeTracking()}startElapsedTimeTracking(){this.stopElapsedTimeTracking(),this.elapsedTime=0,this.intervalId=setInterval(()=>{this.elapsedTime++,this.updateElapsedTimeDisplay()},1e3)}stopElapsedTimeTracking(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}updateElapsedTimeDisplay(){if(this.elapsedTime>0){const e=this.formatElapsedTime(this.elapsedTime);$(".save-message").text(e)}}formatElapsedTime(e){return e<60?`${e}s ago`:e<3600?`${Math.floor(e/60)}m ago`:`${Math.floor(e/3600)}h ago`}toggleAutoSave(){const e=$("#auto-save-toggle");this.isAutoSaveEnabled=e.is(":checked"),this.isAutoSaveEnabled?this.showMessage("Auto-save enabled - changes will be saved automatically","success"):this.showMessage("Auto-save disabled - manual save required","info");try{localStorage.setItem("ace_redis_auto_save_enabled",this.isAutoSaveEnabled?"1":"0")}catch(e){}if("undefined"!=typeof ace_redis_admin&&ace_redis_admin.ajax_url)try{jQuery.post(ace_redis_admin.ajax_url,{action:"ace_redis_toggle_autosave",nonce:ace_redis_admin.nonce,enabled:this.isAutoSaveEnabled?1:0})}catch(e){}}destroy(){this.stopElapsedTimeTracking(),$(this.options.containerSelector).off("input change"),$(document).off("click","#save-bar-button"),$(document).off("change","#auto-save-toggle"),$(window).off("resize scroll load"),$(window).off("beforeunload"),$(".ace-redis-save-bar").remove(),this.isInitialized=!1}};!function(s){window.AceRedisCacheSaveBar=e;class t{constructor(){this.originalFormData=null,this.init()}init(){this.initTabs(),this.initToggleSwitch(),this.initCacheMode(),this.initConnectionTest(),this.initCacheManagement(),this.initDiagnostics(),this.initPerformanceMetrics(),this.initAjaxForm(),this.initFormValidation(),this.initChangeTracking(),this.initSaveBar()}initSaveBar(){if(void 0!==window.AceRedisCacheSaveBar){let e=!0;if("undefined"!=typeof ace_redis_admin&&null!==ace_redis_admin.user_auto_save)e=!!ace_redis_admin.user_auto_save;else try{const s=localStorage.getItem("ace_redis_auto_save_enabled");null!==s&&(e="1"===s)}catch(e){}this.saveBar=new window.AceRedisCacheSaveBar({containerSelector:"#ace-redis-settings-form",saveButtonSelector:"#ace-redis-save-btn",messageContainerSelector:"#ace-redis-messages",onSave:()=>this.saveSettingsViaSaveBar(),autoSaveEnabled:e,autoSaveInterval:15e3}),console.log("SaveBar initialized successfully")}else console.warn("SaveBar component not loaded, falling back to standard save handling")}async saveSettingsViaSaveBar(){try{const e=await this.performSaveSettings();return e&&setTimeout(()=>{"function"==typeof this.testConnection&&this.testConnection()},1e3),e}catch(e){return console.error("SaveBar save error:",e),!1}}async performSaveSettings(){return new Promise(e=>{s("#ace-redis-settings-form");const t=this.getFormDataObject();s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/settings",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{settings:t,nonce:ace_redis_admin.nonce},success:s=>{s.success?(this.captureOriginalFormData(),e(!0)):e(!1)},error:()=>{e(!1)}})})}initTabs(){s(".nav-tab").on("click",e=>{e.preventDefault();const t=s(e.target).attr("href");this.switchToTab(t),t.startsWith("#")&&(window.location.hash=t)}),s(window).on("hashchange",()=>{this.handleHashChange()}),this.handleHashChange()}switchToTab(e){e&&s(e).length&&(s(".nav-tab").removeClass("nav-tab-active"),s(`.nav-tab[href="${e}"]`).addClass("nav-tab-active"),s(".tab-content.active").removeClass("active"),setTimeout(()=>{s(e).addClass("active"),"#diagnostics"===e?(setTimeout(()=>{s("#refresh-metrics-btn").click()},100),this.resumeAutoRefreshTimer()):this.pauseAutoRefreshTimer()},50))}handleHashChange(){let e=window.location.hash;if(!e||!s(e).length){const t=s(".nav-tab").first().attr("href");t&&(e=t)}e&&s(e).length&&this.switchToTab(e)}initToggleSwitch(){s(".ace-switch input").on("change",function(){const e=s(this),t=e.siblings(".ace-slider");e.is(":checked")?t.addClass("checked"):t.removeClass("checked")})}initCacheMode(){const e=()=>{const e=s("#cache-mode-select").val(),t=s("#block-caching-row"),a=s('input[name="ace_redis_cache_settings[enable_block_caching]"]'),i=s("#transient-cache-row"),n=s('input[name="ace_redis_cache_settings[enable_transient_cache]"]'),o="object"===e;t.toggle(o),i.toggle(o),o||(a.prop("checked",!1),n.prop("checked",!1))};e(),s("#cache-mode-select").on("change",e)}initConnectionTest(){s("#ace-redis-cache-test-btn").on("click",e=>{e.preventDefault(),this.testConnection()}),s("#ace-redis-cache-test-write-btn").on("click",e=>{e.preventDefault(),this.testWriteRead()})}testConnection(){const e=s("#ace-redis-cache-test-btn"),t=e.text();e.text("Testing...").prop("disabled",!0),s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/test-connection",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce}}).done(e=>{e.success?this.updateConnectionStatus(e.data):this.showConnectionError(e.data||"Connection failed")}).fail(()=>{this.showConnectionError("REST API request failed")}).always(()=>{e.text(t).prop("disabled",!1)})}testWriteRead(){const e=s("#ace-redis-cache-test-write-btn"),t=e.text();e.text("Testing...").prop("disabled",!0),s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/test-write-read",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce}}).done(e=>{e.success?this.showNotification(`✅ Write/Read Test Successful\nWrite: ${e.data.write}\nRead: ${e.data.read}\nValue: ${e.data.value}`,"success"):this.showNotification(`❌ Test failed: ${e.data}`,"error")}).fail(()=>{this.showNotification("❌ REST API request failed","error")}).always(()=>{e.text(t).prop("disabled",!1)})}updateConnectionStatus(e){const t=s("#ace-redis-cache-connection"),a=s("#ace-redis-cache-size"),i=s("#redis-server-info"),n=s("#redis-server-type"),o=s("#redis-suggestions");t.text(e.status).removeClass("status-unknown status-error").addClass("status-success");let r=`${e.size} keys (${e.size_kb} KB)`;if(e.debug_info&&(r+=` - ${e.debug_info}`),a.text(r),e.server_type||e.suggestions){if(n.text(e.server_type||"Unknown"),e.suggestions&&e.suggestions.length>0){let s="<p><strong>Recommendations:</strong></p><ul>";e.suggestions.forEach(e=>{s+=`<li>${e}</li>`}),s+="</ul>",o.html(s)}else o.html("<p><strong>Recommendations:</strong> Configuration looks good ✅</p>");i.slideDown(300)}}showConnectionError(e){const t=s("#ace-redis-cache-connection"),a=s("#ace-redis-cache-size"),i=s("#redis-server-info");t.text(e).removeClass("status-unknown status-success").addClass("status-error"),a.text("0 keys (0 KB)"),i.slideUp(300)}initCacheManagement(){s("#ace-redis-cache-flush-btn").on("click",e=>{e.preventDefault(),this.clearAllCache()})}clearAllCache(){if(!confirm("Are you sure you want to clear all cache? This action cannot be undone."))return;const e=s("#ace-redis-cache-flush-btn"),t=e.text();e.text("Clearing...").prop("disabled",!0),s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/flush-cache",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce,type:"all"}}).done(e=>{e.success?(this.showNotification(`✅ ${e.data.message||"Cache cleared successfully"}`,"success"),s("#ace-redis-cache-size").text("0 keys (0 KB)")):this.showNotification(`❌ Failed to clear cache: ${e.data}`,"error")}).fail(()=>{this.showNotification("❌ REST API request failed","error")}).always(()=>{e.text(t).prop("disabled",!1)})}initDiagnostics(){s("#ace-redis-cache-diagnostics-btn").on("click",e=>{e.preventDefault(),this.runDiagnostics()})}runDiagnostics(){const e=s("#ace-redis-cache-diagnostics-btn"),t=s("#diagnostics-results"),a=e.text();e.text("Running...").prop("disabled",!0),t.html("<p>⏳ Running comprehensive diagnostics...</p>"),s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/diagnostics",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},data:{nonce:ace_redis_admin.nonce}}).done(e=>{if(e.success&&e.data){const s=Array.isArray(e.data)?e.data.join("\n"):e.data;t.html(`<pre>${this.escapeHtml(s)}</pre>`)}else t.html(`<p class="error">❌ Failed to load diagnostics: ${e.data||"Unknown error"}</p>`)}).fail(()=>{t.html('<p class="error">❌ Diagnostics REST API request failed</p>')}).always(()=>{e.text(a).prop("disabled",!1)})}initFormValidation(){s("#ace-redis-save-btn").on("click",e=>{if(!this.validateForm())return e.preventDefault(),!1}),s("#redis_host").on("blur",this.validateHost),s("#redis_port").on("blur",this.validatePort),s("#cache_ttl").on("blur",this.validateTTL)}validateForm(){let e=!0;const t=[];s("#redis_host").val().trim()||(t.push("Redis host is required"),e=!1);const a=parseInt(s("#redis_port").val());(!a||a<1||a>65535)&&(t.push("Redis port must be between 1 and 65535"),e=!1);const i=parseInt(s("#cache_ttl").val());return(!i||i<60)&&(t.push("Cache TTL must be at least 60 seconds"),e=!1),e||this.showNotification(`❌ Validation errors:\n${t.join("\n")}`,"error"),e}validateHost(){const e=s(this);return e.val().trim()?(e.removeClass("error"),!0):(e.addClass("error"),!1)}validatePort(){const e=s(this),t=parseInt(e.val());return!t||t<1||t>65535?(e.addClass("error"),!1):(e.removeClass("error"),!0)}validateTTL(){const e=s(this),t=parseInt(e.val());return!t||t<60?(e.addClass("error"),!1):(e.removeClass("error"),!0)}showNotification(e,s="info"){alert(e)}initAjaxForm(){console.log("Initializing AJAX form..."),s("#ace-redis-settings-form").on("submit",e=>(console.log("Form submit intercepted"),e.preventDefault(),e.stopPropagation(),this.saveSettings(),!1)),s("#ace-redis-save-btn").on("click",e=>(console.log("Save button clicked"),e.preventDefault(),e.stopPropagation(),this.saveSettings(),!1))}initChangeTracking(){setTimeout(()=>{const e=s("#ace-redis-save-btn");e.data("original-text")||e.data("original-text",e.val()),this.captureOriginalFormData(),this.updateSaveButtonState(),s("#ace-redis-settings-form input, #ace-redis-settings-form select, #ace-redis-settings-form textarea").on("input change",()=>{setTimeout(()=>this.updateSaveButtonState(),10)})},100)}captureOriginalFormData(){this.originalFormData=this.getFormDataObject()}hasFormChanges(){if(!this.originalFormData)return!1;const e=this.getFormDataObject();return JSON.stringify(this.originalFormData)!==JSON.stringify(e)}updateSaveButtonState(){const e=s("#ace-redis-save-btn"),t=this.hasFormChanges();e.prop("disabled",!t),t?e.val(e.data("original-text")||"Save Changes"):e.val(e.data("original-text")||"Save Changes (No Changes)")}getFormDataObject(){const e=s("#ace-redis-settings-form"),t={};return e.serializeArray().forEach(e=>{if(e.name.startsWith("ace_redis_cache_settings[")){const s=e.name.replace("ace_redis_cache_settings[","").replace("]","");t[s]=e.value}}),e.find('input[type="checkbox"]').each(function(){const e=s(this).attr("name");if(e&&e.startsWith("ace_redis_cache_settings[")){const a=e.replace("ace_redis_cache_settings[","").replace("]","");t[a]=s(this).is(":checked")?"1":"0"}}),t}saveSettings(){this.saveBar?this.saveBar.handleSave():this.performOriginalSave()}performOriginalSave(){if(!this.hasFormChanges())return void this.showMessage("Error: Failed to save settings. No changes detected or database error.","error");s("#ace-redis-settings-form");const e=s("#ace-redis-save-btn"),t=s("#ace-redis-messages");console.log("REST API Save triggered...");const a=e.val();e.val("Saving...").prop("disabled",!0),t.hide();const i=this.getFormDataObject();console.log("Sending data:",i),console.log("REST URL:",ace_redis_admin.rest_url+"ace-redis-cache/v1/settings"),s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/settings",type:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce),console.log("Set REST nonce:",ace_redis_admin.rest_nonce)},data:{settings:i,nonce:ace_redis_admin.nonce},success:e=>{console.log("Success response:",e),e.success?(this.showMessage(e.message||"Settings saved successfully!","success"),this.captureOriginalFormData(),this.updateSaveButtonState(),setTimeout(()=>{"function"==typeof this.testConnection&&this.testConnection()},1e3)):this.showMessage(e.message||"Failed to save settings","error")},error:(e,s,t)=>{console.error("Save error:",{status:e.status,statusText:e.statusText,responseText:e.responseText,error:t});let a="Network error occurred";a=e.responseJSON&&e.responseJSON.message?e.responseJSON.message:504===e.status?"Gateway timeout - settings may still be saved. Please refresh the page.":403===e.status?"Permission denied. Please refresh the page and try again.":404===e.status?"REST API endpoint not found. The plugin may not be properly configured.":`${t} (Status: ${e.status})`,this.showMessage("Error: "+a,"error")},complete:()=>{e.val(a).prop("disabled",!1)}})}showMessage(e,t="success"){const a=s("#ace-redis-messages"),i="success"===t?"notice-success":"notice-error";a.html(`\n                <div class="notice ${i} is-dismissible">\n                    <p>${this.escapeHtml(e)}</p>\n                    <button type="button" class="notice-dismiss">\n                        <span class="screen-reader-text">Dismiss this notice.</span>\n                    </button>\n                </div>\n            `).show(),"success"===t&&setTimeout(()=>{a.fadeOut()},5e3),a.find(".notice-dismiss").on("click",function(){a.fadeOut()})}initPerformanceMetrics(){s("#diagnostics").hasClass("active")&&setTimeout(()=>{s("#refresh-metrics-btn").click()},100),this.initAutoRefresh(),s("#refresh-metrics-btn").on("click",()=>{this.loadPerformanceMetrics();const e=s("#refresh-metrics-btn");e.prop("disabled",!0).html("⏳"),setTimeout(()=>{e.prop("disabled",!1).html("🔄")},1e3)})}initAutoRefresh(){this.autoRefreshInterval=null,this.countdownInterval=null,this.remainingSeconds=0;const e=()=>{const e=s("#refresh-timer");this.remainingSeconds>0?(e.text(`Next refresh in ${this.remainingSeconds}s`),this.remainingSeconds--):e.text("")};this.startAutoRefresh=t=>{this.autoRefreshInterval&&clearInterval(this.autoRefreshInterval),this.countdownInterval&&clearInterval(this.countdownInterval);const a=s("#refresh-timer");t>0?(this.remainingSeconds=t,this.countdownInterval=setInterval(e,1e3),this.autoRefreshInterval=setInterval(()=>{s("#diagnostics").hasClass("active")&&(s("#refresh-metrics-btn").click(),this.remainingSeconds=t)},1e3*t),e()):a.text("")},s("#auto-refresh-select").on("change",()=>{const e=parseInt(s("#auto-refresh-select").val());this.startAutoRefresh(e)}),this.startAutoRefresh(30)}pauseAutoRefreshTimer(){this.countdownInterval&&clearInterval(this.countdownInterval),s("#refresh-timer").text("")}resumeAutoRefreshTimer(){const e=parseInt(s("#auto-refresh-select").val());e>0&&this.startAutoRefresh(e)}loadPerformanceMetrics(){s("#diagnostics").hasClass("active")&&s.ajax({url:ace_redis_admin.rest_url+"ace-redis-cache/v1/metrics",type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",ace_redis_admin.rest_nonce)},success:e=>{s("#diagnostics").hasClass("active")&&(e.success&&e.data||e.data)&&this.updateMetricsDisplay(e.data)},error:()=>{this.updateMetricsDisplay({cache_hit_rate:"--",total_keys:"--",memory_usage:"--",response_time:"--",uptime:"--",connected_clients:"--",ops_per_sec:"--"})}})}updateMetricsDisplay(e){console.log("Debug keyspace stats:",{hits:e.debug_keyspace_hits,misses:e.debug_keyspace_misses,hit_rate:e.cache_hit_rate}),s("#performance-metrics .metric-card").each(function(){const t=s(this),a=t.find(".metric-value"),i=t.find("h4").text();let n="--";switch(i){case"Cache Hit Rate":n=e.cache_hit_rate||"--";break;case"Total Keys":n=e.total_keys||"--";break;case"Memory Usage":n=e.memory_usage||"--";break;case"Plugin Memory":n=e.plugin_memory_total||"--";const s=t.find(".metric-description"),a=[];e.plugin_memory_page&&a.push(`Page ${e.plugin_memory_page}`),e.plugin_memory_minified&&a.push(`Minified ${e.plugin_memory_minified}`),e.plugin_memory_blocks&&a.push(`Blocks ${e.plugin_memory_blocks}`),e.plugin_memory_transients&&a.push(`Transients ${e.plugin_memory_transients}`),a.length&&s.text(a.join(" | "));break;case"Response Time":n=e.response_time||"--";break;case"Uptime":n=e.uptime||"--";break;case"Connected Clients":n=e.connected_clients||"--";break;case"Operations/sec":case"Ops/sec":n=e.ops_per_sec||"--";break;case"Connection Time":n=e.connection_time||"--"}a.text()!==n?a.fadeOut(100,function(){s(this).text(n).fadeIn(100)}):a.text(n)});const t=(new Date).toLocaleTimeString();s(".metrics-last-updated").text(`Last updated: ${t}`)}escapeHtml(e){const s=document.createElement("div");return s.textContent=e,s.innerHTML}}s(document).ready(()=>{new t})}(jQuery)}();
//# sourceMappingURL=admin.min.js.map